<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Surgical Tray Dashboard</title>
  <style>
    body { font-family: Arial; background:#f5f7fa; }
    table { border-collapse: collapse; width: 100%; background:white; }
    th, td { padding: 10px; border-bottom: 1px solid #ddd; }
    th { background:#0b5ed7; color:white; }
    a.btn { background:#198754; color:white; padding:6px 10px; text-decoration:none; border-radius:4px; }
  </style>
</head>
<body>
<h2>Pending Surgical Trays</h2>
<table id="tbl">
  <thead>
    <tr>
      <th>Tray</th>
      <th>Unit</th>
      <th>Patient</th>
      <th>Hospital No</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<script>
const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSK4y3FW07pLbORvDfTlU3vWnG8m49QP6x4DkyRblTvz9Y8qg4CJuePJn4VqJ0Ew78rANRR7imfxzSP/pub?output=csv';
const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbx0LWStM9hwlEcsDQ_phMCK2Pfghxr6BYRWrQt_A-jH5PLkGU9KogVSE7LJju1_rFd9/exec';

fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split('\n').slice(1);
    const tbody = document.querySelector('#tbl tbody');

    rows.forEach(row => {
      const c = row.split(',');

      // Status column = L = index 11
      if (c[11] && c[11].trim() === 'RECEIVED') {
        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${c[2] || ''}</td>
          <td>${c[7] || ''}</td>
          <td>${c[8] || ''}</td>
          <td>${c[9] || ''}</td>
          <td>
            <a class="btn"
               href="${WEBAPP_URL}?id=${c[0]}"
               target="_blank">
               RETURN
            </a>
          </td>
        `;
        tbody.appendChild(tr);
      }
    });
  })
  .catch(err => {
    document.body.innerHTML =
      '<h3>Error loading data</h3><pre>' + err + '</pre>';
  });
</script>

</body>

</html>



